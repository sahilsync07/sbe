import{g as v}from"./nativeCache-aSId2zMK.js";import{l as i,y as m,o as f,s as d,c as p,d as b}from"./index-D5bctyeh.js";import"./useAdmin-DsMuefRX.js";const g=["src","alt"],U="sbe-images-v1",L={__name:"CachedImage",props:{src:String,alt:String,cacheKey:String},setup(o){const e=o,c=i(e.src),a=i(null),s=async()=>{if(!e.src)return;a.value&&(URL.revokeObjectURL(a.value),a.value=null);const t=e.cacheKey||e.src,r=await v(t);if(r){c.value=r;return}if("caches"in window)try{const l=await(await caches.open(U)).match(t);if(l){const h=await l.blob();a.value=URL.createObjectURL(h),c.value=a.value;return}}catch(n){console.warn("Web Cache check failed",n)}c.value=e.src},u=()=>{c.value!==e.src&&(c.value=e.src)};return m(()=>e.src,s),f(s),d(()=>{a.value&&URL.revokeObjectURL(a.value)}),(t,r)=>(b(),p("img",{src:c.value,alt:o.alt,onError:u},null,40,g))}};export{L as default};
